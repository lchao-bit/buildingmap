### 基于区块链的用户地理信息数据采集和同步
#### 1. 区块链与现有工作的结合
与区块链有关的设计和开发将以开源项目以太坊（Ethereum）为平台进行。将Linux服务器作为全节点、移动设备作为轻节点进行平台部署。由于地理数据较为稳定且数据量较大，故存储在链下的文件系统中。而数据量较少、动态性较强，需要经常进行更新的路况信息则在链上存储。用户对于地理信息数据单元的修改操作也存储在区块链上。 
#### 2. 用户采集数据以及文件差异的表示
用户使用移动设备搭载的定位模块和传感器模块采集基础地理信息、路况信息或者事件信息等数据。对于文件的差异采用记录修改操作的方法表示，与基于数据差异比较的方法相比，这种方法能够减少通过大量数据比较才能确定修改位置所带来的开销，以及更加精确地记录用户的操作并定位冲突的具体位置。  
对于基础地理信息的更新：程序通过道路匹配功能获知需要修改的原有数据对象ID及它们所在的数据块。对相应的数据块修改完毕后，生成类git的差异操作信息文件，包括操作者、时间戳、具体到单个对象的增加、删除和修改操作信息，并将此信息通过地理信息存储智能合约储存到区块链上。  
对于路况信息的更新：程序通过道路匹配功能获知需要修改的原有数据对象的ID，连同处理后得出的路况信息结果，通过路况存储智能合约储存到区块链上。  
#### 3. 节点之间数据的同步以及冲突的消解
在每个节点上，路况信息的新增、更新以及对于基础地理单元的更新操作共同使用一条区块链，通过编写不同的智能合约访问区块链上的相应数据。当区块链上新增一个区块时，通过节点之间的共识机制，使得这一块上的信息同步到其他节点上。对于基础地理数据单元的修改操作，在区块链完成同步操作后，程序会按照此信息的描述到文件系统中重现对应文件的修改操作。而对于路况信息，在区块链同步完成后，后续的访问通过区块链自身功能的支持可以直接获取最后修改版本的信息。通过区块链的跨链机制，能够将新增块的信息同步到不同的区块链上，达到不同层次节点之间的同步目的。如果出现同一时间单位内不同用户对同一对象的修改冲突，则通过区块链上的冲突消解智能合约进行消解。冲突消解的备选方案有：（1）按照时间戳进行判定，后面的操作覆盖前面的操作；（2）为用户赋予不同的重要级别，重要级别较高的用户操作覆盖用户级别较低的用户操作；（3）按照数据精度进行判定：精度更高的数据覆盖精度较低的数据。在冲突消解完毕后，将新增区块说明消解的过程或者结果，并与其他节点进行同步操作。
